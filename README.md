# Концепция безопасности системы "Робот-фармацевт"

## 1. Карточка описания назначения и применения продукта
![L](diagrams/M37.PNG)
- **Продукт**: Робот-фармацевт, который производит лекарство по индивидуальному рецепту.
- **Рецепт включает в себя**:
  а) Точный состав и количество компонентов, порядок и условия изготовления конечного продукта.  
  б) Уникальный идентификатор лекарства, который изготавливается в определённом объёме для индивидуального курса лечения.

## 2. Активы и риски
| Актив               | Угроза                                    | Уязвимость               | Последствие                 |
|---------------------|-------------------------------------------|--------------------------|-----------------------------|
| **Лекарство**       | Нарушение техпроцесса                    | Ошибки в ПО/датчиках     | Вред здоровью пациентов     |
| **Рецептура**       | Утечка коммерческой тайны                | Слабая аутентификация    | Утрата конкурентного преимущества |
| **Персональные данные** | Несанкционированный доступ          | Отсутствие шифрования    | Штрафы до 5% оборота        |
| **Робот**           | Отказ оборудования                       | Износ компонентов        | Простой производства        |
| **Пациенты**        | Приём неправильного лекарства            | Человеческий фактор      | Юридические последствия     |

<!-- DELETE: Удалена обобщенная таблица "Принципы безопасности" -->
<!-- ADD: Новая таблица целей безопасности -->
## 3. Цели безопасности
| Цель безопасности                                                                               | Реализация                                                                 |
|--------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
| **ЦБ1**: Производство только лекарств с корректным составом                                     | Цифровая подпись рецептов (ECDSA), контроль датчиками состава             |
| **ЦБ2**: Недопущение утечки рецептурных данных                                                  | Шифрование (AES-256 + HSM), двухфакторная аутентификация                  |
| **ЦБ3**: Гарантированная доступность производства                                               | Резервный робот + ручной режим                                            |

<!-- ADD: Новая таблица соотнесения ценностей -->
## 4. Соотнесение ценностей и целей
| Ценность               | Негативное событие                          | Оценка ущерба       | Цель безопасности |
|------------------------|---------------------------------------------|---------------------|-------------------|
| **Здоровье пациентов** | Приём бракованного лекарства                | Катастрофический    | ЦБ1              |
| **Коммерческая тайна** | Утечка рецептуры конкурентам               | Высокий            | ЦБ2              |
| **Производство**       | Простой из-за отказа робота                 | Средний            | ЦБ3              |

<!-- DELETE: Удалены общие предположения -->
<!-- ADD: Конкретные предположения -->
## 5. Предположения безопасности
- **Физическая безопасность**: Робот и серверы расположены в охраняемом помещении с контролем доступа.
- **Верификация рецептов**: Врачи клиники проверяют рецепты до передачи в систему.
- **Контроль персонала**: Все операторы проходят ежегодную проверку компетенций.
- **Стабильность сети**: Используется выделенный VLAN с приоритезацией трафика.

## 6. Сценарии функционирования
### 6.1 Нормальный процесс
![Сценарий](diagrams/m31.PNG)
- **Пациент** → **Оператор**: Предоставляет рецепт  
- **Оператор** → **Робот**: Вводит задание (проверка ЦБ2)  
- **Робот** → **Контроллер**: Инструкции с подписью (ЦБ1)  

### 6.2 Негативные сценарии
#### 6.2.1 Утечка рецептуры
![Сценарий](diagrams/2904.PNG)
**Нарушена цель**: ЦБ2  
**Сценарий**: Обход аутентификации → кража данных из БД.  
**Меры**: Усилить контроль доступа (см. раздел 7).

#### 6.2.2 Производство брака
![Архитектура](diagrams/3004.PNG)
**Нарушена цель**: ЦБ1  
**Сценарий**: Сбой датчика → неправильная дозировка.  
**Меры**: Внедрить дублирующие датчики.

## 7. Архитектурная схема
![Архитектура](diagrams/m34.PNG)  
**Ключевые элементы**:  
- Шифрование каналов (ЦБ2)  
- Резервный контроллер (ЦБ3)  
- Подпись инструкций (ЦБ1)
##| Домен безопасности               | Уровень доверия                          | Оценка | Обоснование                                                                 |
|-----------------------------------|------------------------------------------|--------|-----------------------------------------------------------------------------|
| **База данных рецептов**         | Недоверенный                             | MM     | При компрометации возможна утечка данных, но защищено шифрованием (AES-256) |
| **Робот-фармацевт**             | Доверенный                               | MM     | При компрометации нарушается ЦБ3 (доступность производства)                 |
| **Контроллер производства**      | Доверенный, повышающий целостность       | MM     | При компрометации нарушается ЦБ1 (целостность состава лекарств)             |
| **Система аутентификации**       | Доверенный                               | SS     | При компрометации нарушается ЦБ2 (конфиденциальность рецептов)              |
| **Резервная база**               | Недоверенный                             | MS     | В худшем случае возможна задержка данных до 5 минут, не нарушает ЦБ         |
| **HSM для ключей**               | Доверенный                               | SS     | При компрометации нарушается ЦБ2, но защищено физически                     |
| **Система аудита**               | Доверенный                               | SS     | При отказе сохраняется возможность ручного логирования                     |

## 8. Доработанная архитектура
![Защищенная архитектура](diagrams/m35.PNG)  
**Изменения**:  
- Добавлен HSM для ключей (ЦБ2)  
- Введен аудит изменений рецептов (ЦБ1)  

## 9. Роли пользователей
- **Оператор-фармацевт**: Только ввод данных (верификация по ЦБ2).  
- **Техник**: Обслуживание робота (контроль по ЦБ3).  

## 10. Итог
Система обеспечивает:  
1. Безопасность пациентов через **ЦБ1**  
2. Защиту коммерческой тайны через **ЦБ2**  
3. Непрерывность работы через **ЦБ3**  
